{"version":3,"sources":["GameInit.js"],"names":["allParts","CC_WECHATGAME","window","proto","message","DVector2","DVector3","GameInit","loadModule","callback","now","Date","part","pop","require","init","log","info","length","bInited","module","exports"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,WAAW;AACX;AACA;AACA,YAHW,EAIX,eAJW,EAKX,eALW,EAMX,cANW,EAOX,aAPW,EAQX,eARW,EASX,YATW,CAAf;;AAaA;AACA,IAAIC,aAAJ,EAAmB;AACfC,WAAOC,KAAP,GAAe,EAAf;AACAA,UAAMA,KAAN,GAAc,EAAd;AACAA,UAAMC,OAAN,GAAgB,EAAhB;AACAD,UAAMC,OAAN,CAAcC,QAAd,GAAyB,EAAzB;AACAF,UAAMC,OAAN,CAAcE,QAAd,GAAyB,EAAzB;AACH;;AAED,IAAIC,WAAW;AACX;;;;AAIAC,gBAAY,oBAAUC,QAAV,EAAoB;AAAA;;AAC5B,YAAIC,MAAMC,KAAKD,GAAL,EAAV;AACA,YAAIE,OAAOZ,SAASa,GAAT,EAAX;AACAC,gBAAQF,IAAR,EAAcG,IAAd,CAAmB,YAAM;AACrBC,gBAAIC,IAAJ,CAAS,gCAAT,EAA2CL,IAA3C,EAAkDD,KAAKD,GAAL,KAAaA,GAA/D;AACA,gBAAIV,SAASkB,MAAT,GAAkB,CAAtB,EAAyB;AACrB,sBAAKV,UAAL,CAAgBC,QAAhB;AACH,aAFD,MAEO;AACH,oBAAIA,QAAJ,EAAc;AACVA;AACH;AACJ;AACJ,SATD;AAUH,KAlBU;;AAoBX;;;;AAIAM,UAAM,cAAUN,QAAV,EAAoB;AACtB,YAAI,CAAC,CAAC,KAAKU,OAAX,EAAoB;AAChB,gBAAIV,QAAJ,EAAc;AACVA;AACH;AACJ,SAJD,MAIO;AACH,iBAAKD,UAAL,CAAgBC,QAAhB;AACA,iBAAKU,OAAL,GAAe,IAAf;AACH;AACJ;AAjCU,CAAf;;AAoCAC,OAAOC,OAAP,GAAiBd,QAAjB","file":"GameInit.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\framework\\utils","sourcesContent":["/**\r\n * 因为pop()，逆向遍历，注意初始化顺序\r\n */\r\nlet allParts = [\r\n    // 'UIWaiting',\r\n    // 'TrackMgr',\r\n    'NetManager',\r\n    'PrefabManager',\r\n    'SpriteManager',\r\n    'SpineManager',\r\n    'AnimManager',\r\n    'ConfigManager',\r\n    'SpriteHook',\r\n    //'Environment',\r\n];\r\n\r\n//微信小游戏 作用域问题\r\nif (CC_WECHATGAME) {\r\n    window.proto = {};\r\n    proto.proto = {};\r\n    proto.message = {};\r\n    proto.message.DVector2 = {};\r\n    proto.message.DVector3 = {};\r\n}\r\n\r\nlet GameInit = {\r\n    /**\r\n     * 加载游戏模块\r\n     * @param {*加载成功回调} callback \r\n     */\r\n    loadModule: function (callback) {\r\n        let now = Date.now();\r\n        let part = allParts.pop();\r\n        require(part).init(() => {\r\n            log.info('module ({}) is loaded, time:{}', part, (Date.now() - now));\r\n            if (allParts.length > 0) {\r\n                this.loadModule(callback);\r\n            } else {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * 初始化游戏\r\n     * @param {*初始化成功回调} callback \r\n     */\r\n    init: function (callback) {\r\n        if (!!this.bInited) {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        } else {\r\n            this.loadModule(callback);\r\n            this.bInited = true;\r\n        }\r\n    },\r\n}\r\n\r\nmodule.exports = GameInit;\r\n"]}