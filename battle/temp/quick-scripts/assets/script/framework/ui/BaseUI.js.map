{"version":3,"sources":["BaseUI.js"],"names":["ViewManager","require","ConfigManager","AudioManager","Global","cc","Class","extends","Component","ctor","parentLayer","getUILayerFromScene","maskOpacity","setClickOtherClose","isClose","clickOther","setData","data","moduleBGShow","playEffect","simpleTipEffect","bg","node","getChildByName","visibleSize","view","getVisibleSize","setContentSize","width","height","isValid","opacity","runAction","sequence","delayTime","fadeTo","on","Node","EventType","TOUCH_END","closeByClickOther","hideCloseBtn","btnClose","onShow","prefab","self","inData","showUI","parent","action","game","Types","ActionType","Jump","onClose","config","EventManager","targetOff","stopAllActions","unscheduleAllCallbacks","simpleBtnEffect","hideUI","uuid","event","rect","getBoundingBox","clickPos","getLocation","x","y","contains","clickContainer"],"mappings":"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","file":"BaseUI.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\framework\\ui","sourcesContent":["const ViewManager = require('ViewManager');\r\nconst ConfigManager = require('ConfigManager');\r\nconst AudioManager = require('AudioManager');\r\nconst Global = require('Global');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    \r\n    ctor() {\r\n        this.parentLayer = ViewManager.getUILayerFromScene();\r\n        this.maskOpacity = 175;\r\n    },\r\n\r\n    setClickOtherClose: function(isClose){\r\n        this.clickOther = isClose;\r\n    },\r\n\r\n    setData: function(data){\r\n        this.data = data;\r\n    },\r\n\r\n    moduleBGShow: function(){\r\n        // 通用弹板 音效\r\n        AudioManager.playEffect(Global.simpleTipEffect);\r\n        Global.simpleTipEffect = \"tongyong_tanban\";\r\n        let bg = this.node.getChildByName('modalbg');\r\n        let visibleSize =  cc.view.getVisibleSize(); \r\n        bg.setContentSize(visibleSize.width, visibleSize.height);\r\n        if (cc.isValid(bg)) {\r\n            bg.opacity = 0;\r\n            this.maskOpacity = this.maskOpacity ? this.maskOpacity : 175;\r\n            bg.runAction(cc.sequence(cc.delayTime(0.3),cc.fadeTo(0.01,this.maskOpacity)));\r\n            if (this.clickOther) {\r\n                bg.on(cc.Node.EventType.TOUCH_END,this.closeByClickOther,this);    \r\n            }\r\n            \r\n        }\r\n        \r\n    },\r\n    //关闭面板时 先隐藏按钮\r\n    hideCloseBtn: function(){\r\n        let btnClose =  this.node.getChildByName('btnClose');\r\n        if (cc.isValid(btnClose)) {\r\n            btnClose.opacity = 0;\r\n        }\r\n    },\r\n\r\n    onShow: function(prefab,data){\r\n        let self = this;\r\n        this.inData = data;\r\n        ViewManager.showUI({\r\n            prefab: prefab,\r\n            parent: self.parentLayer,\r\n            action: game.Types.ActionType.Jump\r\n        });\r\n        this.moduleBGShow();\r\n    },\r\n\r\n    onClose: function(config) {\r\n        let bg = this.node.getChildByName('modalbg');\r\n        if (cc.isValid(bg)) {\r\n            bg.opacity = 0;\r\n        }\r\n        this.hideCloseBtn();\r\n        game.EventManager.targetOff(this);\r\n        this.node.stopAllActions();\r\n        this.node.targetOff(this.node);\r\n        this.unscheduleAllCallbacks();\r\n        let self = this;\r\n        Global.simpleBtnEffect = (config && config.simpleBtnEffect) ? config.simpleBtnEffect: \"tongyong_quxiao\";\r\n        ViewManager.hideUI({uuid: self.node.uuid,action: game.Types.ActionType.Jump});\r\n    },\r\n    \r\n\r\n    closeByClickOther: function(event){\r\n        let rect = this.node.getBoundingBox();\r\n        let clickPos = event.getLocation();\r\n        let visibleSize =  cc.view.getVisibleSize(); \r\n        clickPos.x = clickPos.x - visibleSize.width/2;\r\n        clickPos.y = clickPos.y - visibleSize.height/2;\r\n        if (!rect.contains(clickPos)) {\r\n            this.onClose();\r\n        } else {\r\n            this.clickContainer();\r\n        }\r\n        \r\n    },\r\n\r\n    clickContainer: function(){\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n\r\n\r\n\r\n"]}